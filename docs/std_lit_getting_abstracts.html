<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Small Effects, Air Pollution and Health: Automated literature review: getting abstracts</title>

  <meta property="description" itemprop="description" content="In the present document, we retrieve abstracts for our automated review of the literature on short term health effects of air pollution, focusing mainly on the epidemiology literature."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2023-03-29"/>
  <meta property="article:created" itemprop="dateCreated" content="2023-03-29"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Small Effects, Air Pollution and Health: Automated literature review: getting abstracts"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In the present document, we retrieve abstracts for our automated review of the literature on short term health effects of air pollution, focusing mainly on the epidemiology literature."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Small Effects, Air Pollution and Health"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Small Effects, Air Pollution and Health: Automated literature review: getting abstracts"/>
  <meta property="twitter:description" content="In the present document, we retrieve abstracts for our automated review of the literature on short term health effects of air pollution, focusing mainly on the epidemiology literature."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","date","output","editor_options"]}},"value":[{"type":"character","attributes":{},"value":["Automated literature review: getting abstracts"]},{"type":"character","attributes":{},"value":["In the present document, we retrieve abstracts for our automated review of the literature on short term health effects of air pollution, focusing mainly on the epidemiology literature."]},{"type":"character","attributes":{},"value":["2023-03-29"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */
  @import url('https://fonts.googleapis.com/css2?family=Lato');
  @import url('https://fonts.googleapis.com/css2?family=Lora');


  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       13px;
    --aside-size:      12px;
    --fig-cap-size:    12px;
    /*-- Main font colors --*/
    --title-color:     rgba(0, 129, 167, 1);
    --header-color:    rgba(0, 129, 167, 1);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    --hover-color:     rgba(0, 129, 167, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    "Lato", sans-serif;
    --body-font:       "Lora", serif;
    --navbar-font:     "Lato", sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --font-family:      'Lato', sans-serif;
    --title-size:       21px;
    --text-color:       rgba(0, 129, 167, 1);
    --text-size:        18px;
    --hover-color:      rgba(0, 129, 167, 0.6);
    --bkgd-color:       rgba(255, 255, 255, 0.8);
    font-variant:       small-caps;
  }

  .nav-dropdown .nav-dropbtn {
    font-variant: small-caps;
  }

  .distill-site-footer {
    --text-color:       rgba(10, 10, 10, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       rgba(240, 240, 240, 0.8); 
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */

  /* Postcard headers */
  h1, h2, h3 {
    color:              rgba(0, 129, 167, 1);
    font-variant:       small-caps;
  }

  p {
    color:              rgba(0, 0, 0, 0.8);
  }

  a {
  	color:              rgba(0, 129, 167, 1);
  }

  a:hover {
  	color:              rgba(0, 129, 167, 0.6);
  }

  /* Buttons on postcard */
  .btn-outline-dark {
      color:            rgba(0, 129, 167, 1);
      border-color:     rgba(0, 129, 167, 1);
  }

  .btn-outline-dark:hover {
      background-color: rgba(0, 129, 167, 1);
      color:            white;
  }

  /*body {
    background-color: rgba(249, 250, 247, 0.8);
  }*/</style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
  <script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <link href="site_libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
  <script src="site_libs/str_view-binding-1.4.1/str_view.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Automated literature review: getting abstracts","description":"In the present document, we retrieve abstracts for our automated review of the literature on short term health effects of air pollution, focusing mainly on the epidemiology literature.","authors":[],"publishedDate":"2023-03-29T00:00:00.000-04:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Small Effects, Air Pollution and Health</a>
</div>
<div class="nav-right">
<a href="inference_pollution_paper.pdf">Paper</a>
<a href="summary.html">Summary</a>
<a href="intuition.html">Intuition</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Literature review
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="std_lit_getting_abstracts.html">Retrieving abstracts from the standard literature</a>
<a href="std_lit_analysis.html">Analysis of the standard literature</a>
<a href="meta_analysis_epi.html">Study of a meta-analysis</a>
<hr/>
<a href="causal_lit_overview.html">Analysis of the causal literature</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Simulations
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="notes_methodo.html">Overall approach</a>
<a href="power_sim.html">Running the simulations</a>
<a href="sim_results.html">Analysing simulations results</a>
<hr/>
<span class="nav-dropdown-header">Exploratory data analysis</span>
<span class="nav-dropdown-header">Data wrangling</span>
</div>
</div>
<a href="how_to_retro.html">Recommendations</a>
<a href="https://github.com/vincentbagilet/inference_pollution" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Automated literature review: getting abstracts</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>In the present document, we retrieve abstracts for our automated review of the literature on short term health effects of air pollution, focusing mainly on the epidemiology literature.</p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#overall-approach" id="toc-overall-approach">Overall approach</a></li>
<li><a href="#selecting-articles-and-retrieving-metadata" id="toc-selecting-articles-and-retrieving-metadata">Selecting articles and retrieving metadata</a>
<ul>
<li><a href="#set-of-articles-to-consider" id="toc-set-of-articles-to-consider">Set of articles to consider</a></li>
</ul></li>
<li><a href="#retreiving-abstracts" id="toc-retreiving-abstracts">Retreiving abstracts</a></li>
<li><a href="#retreiving-effects-and-confidence-interavals" id="toc-retreiving-effects-and-confidence-interavals">Retreiving effects and confidence interavals</a>
<ul>
<li><a href="#expression-in-terms-of-percentage-change" id="toc-expression-in-terms-of-percentage-change">Expression in terms of percentage change</a></li>
<li><a href="#filtering-out-invalid-articles" id="toc-filtering-out-invalid-articles">Filtering out invalid articles</a></li>
</ul></li>
<li><a href="#retreiving-additional-information" id="toc-retreiving-additional-information">Retreiving additional information</a>
<ul>
<li><a href="#number-of-obsrvations" id="toc-number-of-obsrvations">Number of obsrvations</a></li>
<li><a href="#pollutant-studied" id="toc-pollutant-studied">Pollutant studied</a></li>
<li><a href="#outcome-considered" id="toc-outcome-considered">Outcome considered</a></li>
<li><a href="#sub-population-considered" id="toc-sub-population-considered">Sub-population considered</a></li>
<li><a href="#additional-information-on-journals" id="toc-additional-information-on-journals">Additional information on journals</a></li>
</ul></li>
<li><a href="#agregating-the-information" id="toc-agregating-the-information">Agregating the information</a></li>
</ul>
</nav>
</div>
<style>
body {
text-align: justify}
</style>
<h2 id="overall-approach">Overall approach</h2>
<p>We take advantage of a somehow standardized reporting mechanism to retrieve point estimates and confidence intervals from the abstracts using REGular EXPressions (regex).</p>
<p>The algorithm we wrote is not perfect: it probably does not detect all estimates and may pick up some incorrect point estimates and/or standard error. However, based on quick non-automated checks we ran, these potential issues seem very limited. Retrieving all this information via careful reading of the abstracts would have been extremely cumbersome. This automated analysis is an important time saver. Importantly, the analysis carried out for this literature could be easily replicated for another literature, based on the code used and described in this document.</p>
<h2 id="selecting-articles-and-retrieving-metadata">Selecting articles and retrieving metadata</h2>
<p>We use the <a href="https://books.ropensci.org/fulltext/"><code>fulltext</code></a> package to get the abstract of each article corresponding to our search query.
<!-- This set of articles might be too restrictive and we may want to broaden our scope later.  --></p>
<p>We focus on articles published on Scopus and Pubmed. To access Scopus API, one needs to register to get an API key (stored in the .Renviron) for Elsevier and a Crossref TDM API key.
<!-- Note that downloading of full texts may not work if one is not connected directly to their institution internet network.  -->
Pubmed articles are accessed via Entrez. An API key enables to increase the number of requests per seconds from 3 to 10. More information on authentication is available on <a href="https://books.ropensci.org/fulltext/authentication.html">the <code>fulltext</code> manual</a>.</p>
<h3 id="set-of-articles-to-consider">Set of articles to consider</h3>
<p>First of all, we need to clearly define the set of articles we want to consider in this analysis. Our search query is:</p>
<p>TITLE((air pollution OR air quality OR particulate matter OR ozone OR nitrogen dioxide OR sulfur dioxide OR PM10 OR PM2.5 OR carbon dioxide OR carbon monoxide) AND (emergency OR mortality OR stroke OR cerebrovascular OR cardiovascular OR death OR hospitalization) AND NOT (long term OR long-term)) AND short term</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>query</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'TITLE(("air pollution" OR "air quality" OR "particulate matter" OR "ozone"'</span>, </span>
<span>        <span class='st'>'OR "nitrogen dioxide" OR "sulfur dioxide" OR "PM10" OR "PM2.5" OR'</span>, </span>
<span>        <span class='st'>' "carbon dioxide" OR "carbon monoxide")'</span>, </span>
<span>        <span class='st'>'AND ("emergency" OR "mortality" OR "stroke" OR "cerebrovascular" OR'</span>, </span>
<span>        <span class='st'>'"cardiovascular" OR "death" OR "hospitalization")'</span> ,</span>
<span>        <span class='st'>'AND NOT ("long term" OR "long-term")) AND "short term"'</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>opts_entrez</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>use_history <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Run a search</span></span>
<span><span class='va'>search</span> <span class='op'>&lt;-</span> <span class='fu'>ft_search</span><span class='op'>(</span><span class='va'>query</span>, from <span class='op'>=</span> <span class='st'>"scopus"</span>, limit <span class='op'>=</span> <span class='fl'>2000</span><span class='op'>)</span></span>
<span><span class='va'>search_entrez</span> <span class='op'>&lt;-</span> <span class='fu'>ft_search</span><span class='op'>(</span></span>
<span>  <span class='fu'>str_replace</span><span class='op'>(</span><span class='va'>query</span>, <span class='st'>"AND NOT"</span>, <span class='st'>"NOT"</span><span class='op'>)</span>, </span>
<span>  from <span class='op'>=</span> <span class='st'>"entrez"</span>, </span>
<span>  limit <span class='op'>=</span> <span class='fl'>300</span>, </span>
<span>  entrezopts <span class='op'>=</span> <span class='va'>opts_entrez</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We then retrieve and wrangle the related metadata. The metadata from different sources having different shapes, we only select a few relevant columns to build an overall metadata set.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>metadata_scopus</span> <span class='op'>&lt;-</span> <span class='va'>search</span><span class='op'>$</span><span class='va'>scopus</span><span class='op'>$</span><span class='va'>data</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename_all</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, <span class='st'>"prism:|dc:"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename_all</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, <span class='st'>"-"</span>, <span class='st'>"_"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>title</span>, <span class='va'>creator</span>, <span class='va'>publicationName</span>, <span class='va'>pubmed_id</span>, <span class='va'>coverDate</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename</span><span class='op'>(</span></span>
<span>    authors <span class='op'>=</span> <span class='va'>creator</span>,</span>
<span>    journal <span class='op'>=</span> <span class='va'>publicationName</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    pubmed_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>pubmed_id</span>, <span class='st'>"[0-9]{7}"</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>pubmed_id</span><span class='op'>)</span>,</span>
<span>    pub_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>coverDate</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>coverDate</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>metadata_scopus</span>, <span class='st'>"data/literature_review_epi/outputs/metadata_scopus.RDS"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>metadata_entrez</span> <span class='op'>&lt;-</span> <span class='va'>search_entrez</span><span class='op'>$</span><span class='va'>entrez</span><span class='op'>$</span><span class='va'>data</span> <span class='op'>%&gt;%</span> <span class='co'>#search_entrez$entrez$data </span></span>
<span>  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='co'># rename(id = uid) %&gt;% </span></span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>title</span>, <span class='va'>authors</span>, <span class='va'>fulljournalname</span>, <span class='va'>pmid</span>, <span class='va'>pubdate</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename</span><span class='op'>(</span></span>
<span>    journal <span class='op'>=</span> <span class='va'>fulljournalname</span>,</span>
<span>    pubmed_id <span class='op'>=</span> <span class='va'>pmid</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    pubmed_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>pubmed_id</span>, <span class='st'>"[0-9]{7}"</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>pubmed_id</span><span class='op'>)</span>,</span>
<span>    pub_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>pubdate</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>pubdate</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>metadata_entrez</span>, <span class='st'>"data/literature_review_epi/outputs/metadata_entrez.RDS"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>metadata_lit_review</span> <span class='op'>&lt;-</span> <span class='va'>metadata_scopus</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>metadata_entrez</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>pb_doi <span class='op'>=</span> <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>doi</span>, <span class='st'>"[&lt;&gt;;]"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#some dois are not valid</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pb_doi</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>pb_doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pub_date</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>pub_date</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#some articles have been published twice</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>n_with_doi <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n_with_doi</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>n_with_doi</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>pubmed_id</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>pubmed_id</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='co'>#two weird articles with separate author names, I select one randomly</span></span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>n_with_doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>title</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># saveRDS(metadata_lit_review, "data/literature_review_epi/outputs/metadata_lit_review.RDS")</span></span></code></pre>
</div>
</div>
<h2 id="retreiving-abstracts">Retreiving abstracts</h2>
<p>There is no <code>fulltext</code> function to access abstracts from Entrez. Therefore, using the DOI, we get the abstracts from Semantic Scholar. We also access Scopus abstracts from Semantic Scholar since, due to an IP address constraint we cannot access the texts and abstracts from Scopus.</p>
<p>In Semantic Scholar, there is a rate limit of 100 articles per 5 min or 20 articles per minute. We therefore need to pause the system to be able to download everything. In addition, some DOIs are not valid so we filtered them out in a previous step (<code>pb_doi</code>).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>get_abstracts</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>vect_doi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span></span>
<span>  <span class='va'>number_periods</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vect_doi</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%/%</a></span> <span class='fl'>20</span></span>
<span>  <span class='va'>abs</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"Total downloading time: "</span>, <span class='va'>number_periods</span>, <span class='st'>"min"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>0</span><span class='op'>:</span><span class='va'>number_periods</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    </span>
<span>    <span class='va'>doi_period</span> <span class='op'>&lt;-</span> <span class='va'>vect_doi</span><span class='op'>[</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>*</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>*</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span></span>
<span>    <span class='va'>doi_period</span> <span class='op'>&lt;-</span> <span class='va'>doi_period</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>doi_period</span><span class='op'>)</span><span class='op'>]</span></span>
<span>    </span>
<span>    <span class='va'>skip_to_next</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span> <span class='co'>#to handle issues, using tryCatch</span></span>
<span>    </span>
<span>    <span class='va'>possible_error</span> <span class='op'>&lt;-</span> <span class='kw'><a href='https://rdrr.io/r/base/conditions.html'>tryCatch</a></span><span class='op'>(</span></span>
<span>      <span class='va'>abs_period</span> <span class='op'>&lt;-</span> <span class='va'>doi_period</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='fu'>ft_abstract</span><span class='op'>(</span>from <span class='op'>=</span> <span class='st'>"semanticscholar"</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='va'>.</span><span class='op'>$</span><span class='va'>semanticscholar</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='fu'>unnest</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"doi"</span>, values_to <span class='op'>=</span> <span class='st'>"abstract"</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>doi</span> <span class='op'>!=</span> <span class='va'>abstract</span><span class='op'>)</span>,</span>
<span>      error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>e</span><span class='op'>)</span> <span class='va'>e</span></span>
<span>    <span class='op'>)</span></span>
<span>    </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>inherits</a></span><span class='op'>(</span><span class='va'>possible_error</span>, <span class='st'>"error"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'><a href='https://rdrr.io/r/base/warning.html'>warning</a></span><span class='op'>(</span></span>
<span>        <span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"The abstracts for the following articles could not be downloaded: "</span>,</span>
<span>              <span class='fu'>str_c</span><span class='op'>(</span><span class='va'>doi_period</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='kw'>next</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>       <span class='va'>abs</span> <span class='op'>&lt;-</span> <span class='va'>abs</span> <span class='op'>%&gt;%</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>abs_period</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>    </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>&lt;</span> <span class='va'>number_periods</span> <span class='op'>&amp;</span> <span class='va'>number_periods</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"Remaining time: "</span>, <span class='op'>(</span><span class='va'>number_periods</span> <span class='op'>-</span> <span class='va'>i</span><span class='op'>)</span>, <span class='st'>"min"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Sys.sleep.html'>Sys.sleep</a></span><span class='op'>(</span><span class='fl'>63</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span> </span>
<span>  </span>
<span>  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>abs</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'>#run this from the console to see the time remaining (copy/paste it)</span></span>
<span><span class='va'>abstracts</span> <span class='op'>&lt;-</span> <span class='va'>metadata_lit_review</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='va'>.</span><span class='op'>$</span><span class='va'>doi</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>get_abstracts</span><span class='op'>(</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>metadata_lit_review</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># saveRDS(abstracts, "data/literature_review_epi/outputs/abstracts.RDS")</span></span></code></pre>
</div>
</div>
<h2 id="retreiving-effects-and-confidence-interavals">Retreiving effects and confidence interavals</h2>
<p>Now that we have retrieved the abstracts, we want to extract the effects and associated confidence intervals. Part of the literature, displays directly effects and 95% confidence intervals in their abstracts.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> We identify effects and CIs as follows:</p>
<ul>
<li>CI: any couple of numbers following by less than 4 characters a string describing a confidence interval (95%, CI, confidence interval). We also consider confidence intervals of the shape (-8.7, 54.7): it needs to have a shape (number separator number) and needs to be preceded by a number, less than 5 characters away.</li>
<li>Effect: the first number preceding by less than 30 characters a similar string describing a confidence interval (apart numbers used to describe the 95 of a 95% CI).</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>string_confint</span> <span class='op'>&lt;-</span> <span class='fu'>str_c</span><span class='op'>(</span></span>
<span>  <span class='st'>"((?&lt;!(\\d\\.|\\d))95\\s?%|(?&lt;!(\\d\\.|\\d))95\\s(per(\\s?)cent)|"</span>,</span>
<span>  <span class='st'>"\\bC(\\.)?(I|l)(\\.)?(s?)\\b|\\bPI(s?)\\b|\\b(i|I)nterval|"</span>,</span>
<span>  <span class='st'>"\\b(c|C)onfidence\\s(i|I)nterval|\\b(c|C)redible\\s(i|I)nterval|"</span>, </span>
<span>  <span class='st'>"\\b(p|P)osterior\\s(i|I)nterval)"</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>num_confint</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"(-\\s?|\\s?)?[\\d\\.]{1,7}[\\s:\\~;,%\\-to\\-]{1,5}(-\\s?|\\s?)?[\\d\\.]{1,7}"</span></span>
<span><span class='va'>num_effect</span> <span class='op'>&lt;-</span> <span class='st'>"(-\\s?|\\s?)?[\\d\\.]{1,7}"</span></span>
<span></span>
<span><span class='va'>detected_effects</span> <span class='op'>&lt;-</span> <span class='va'>abstracts</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>abstract <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>abstract</span>, <span class='st'>""</span>, <span class='st'>"."</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>abstract</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>unnest_tokens</span><span class='op'>(</span></span>
<span>    <span class='va'>sentence</span>,</span>
<span>    <span class='va'>abstract</span>,</span>
<span>    token <span class='op'>=</span> <span class='st'>"sentences"</span>,</span>
<span>    to_lower <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    drop <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    <span class='co'># contains_CI = str_detect(sentence, string_confint),</span></span>
<span>    sentence <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span></span>
<span>      <span class='va'>sentence</span>,</span>
<span>      <span class='st'>"(?&lt;=(?&lt;!\\.)(?&lt;!\\d)\\d{1,4}),(?=(\\d{3}(?!\\.)))"</span>,</span>
<span>      <span class='st'>""</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='co'># filter(contains_CI) %&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    CI <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>sentence</span>,</span>
<span>      <span class='fu'>str_c</span><span class='op'>(</span></span>
<span>        <span class='st'>"((?&lt;="</span>, <span class='va'>string_confint</span>, <span class='st'>"[^\\d]{0,4})"</span>, <span class='va'>num_confint</span>,<span class='st'>")|"</span>,</span>
<span>        <span class='st'>"(?&lt;="</span>, <span class='va'>num_effect</span>,<span class='st'>"[^\\d\\.]{0,5})"</span>, </span>
<span>        <span class='st'>"(?&lt;=(\\(|\\[))"</span>, <span class='va'>num_confint</span>,<span class='st'>"(?=%?[\\)\\];])"</span></span>
<span>      <span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    effect <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>sentence</span>,</span>
<span>      <span class='fu'>str_c</span><span class='op'>(</span></span>
<span>        <span class='va'>num_effect</span>,</span>
<span>        <span class='st'>"(?=[^\\d\\.]{0,30}([^\\.\\d]"</span>, <span class='va'>string_confint</span>,<span class='st'>"))(?&lt;![^\\.\\d]95)|"</span>,</span>
<span>        <span class='va'>num_effect</span>,</span>
<span>        <span class='st'>"(?=[^\\d\\.]{0,5}(\\(|\\[)"</span>, <span class='va'>num_confint</span>, <span class='st'>"(?=%?[\\)\\];]))(?&lt;![^\\.\\d]95)"</span></span>
<span>      <span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>These lines of code return a set of confidence intervals and effects for each sentence containing the phrase (CI, confidence interval, etc).
<!-- We could improve this code by linking directly each effect to its confidence interval.  -->
For now, if we do not detect the same number of effects and confidence interval in a sentence, we drop the sentence, even though there are 5 pairs of effect-CI and only one of them is badly detected.</p>
<p>Note that some problems might remain with our estimates and CIs detected. Yet, a vast majority of estimates seems to be correctly detected. Here are examples of the confidence intervals and effects detected using our current method:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>sentences_with_CI</span> <span class='op'>&lt;-</span> <span class='va'>detected_effects</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>CI</span> <span class='op'>!=</span> <span class='st'>"character(0)"</span> <span class='op'>&amp;</span> <span class='va'>effect</span> <span class='op'>!=</span> <span class='st'>"character(0)"</span><span class='op'>)</span></span>
<span><span class='va'>random_sentences</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>sentences_with_CI</span><span class='op'>$</span><span class='va'>sentence</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>)</span></span>
<span><span class='fu'>str_view_all</span><span class='op'>(</span></span>
<span>  <span class='va'>sentences_with_CI</span><span class='op'>$</span><span class='va'>sentence</span><span class='op'>[</span><span class='va'>random_sentences</span><span class='op'>]</span>,</span>
<span>  <span class='fu'>str_c</span><span class='op'>(</span></span>
<span>    <span class='va'>num_effect</span>,</span>
<span>    <span class='st'>"(?=[^\\d\\.]{0,17}([^\\.\\d]"</span>, <span class='va'>string_confint</span>, <span class='st'>"))(?&lt;![^\\.\\d]95)|"</span>,</span>
<span>    <span class='va'>num_effect</span>,</span>
<span>    <span class='st'>"(?=[^\\d\\.]{0,5}(\\(|\\[)"</span>, <span class='va'>num_confint</span>, <span class='st'>"(?=%?[\\)\\];]))(?&lt;![^\\.\\d]95)"</span>,</span>
<span>    <span class='st'>"|((?&lt;="</span>, <span class='va'>string_confint</span>, <span class='st'>"[^\\d]{0,4})"</span>, <span class='va'>num_confint</span>,<span class='st'>")|"</span>,</span>
<span>    <span class='st'>"(?&lt;="</span>, <span class='va'>num_effect</span>,<span class='st'>"[^\\d\\.]{0,5})(?&lt;=(\\(|\\[))"</span>, <span class='va'>num_confint</span>, <span class='st'>"(?=%?[\\)\\];])"</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<div id="htmlwidget-d378166bdc9ae114e5c2" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-d378166bdc9ae114e5c2">{"x":{"html":"<ul>\n  <li>Results The excess risk for non-accidental mortality was <span class='match'>1.3<\/span>% [95% confidence interval (CI), <span class='match'>0.81.7<\/span>] per 10 g/m3 of PM10, with higher excess risks for cardiovascular and above age 65 mortality of <span class='match'>1.9<\/span>% (95% CI, <span class='match'>0.83.0<\/span>) and <span class='match'>1.5<\/span>% (95% CI, <span class='match'>0.92.1<\/span>), respectively.<\/li>\n  <li>After adjustment, top (hazard ratio [HR], <span class='match'>1.48<\/span>; 95% confidence interval [CI], <span class='match'>1.08-2.04<\/span>; P=.016) and bottom (HR, <span class='match'>1.54<\/span>; 95% CI, <span class='match'>1.08-2.18<\/span>; P=.017) quartiles of BE were associated with increased risk of readmission or death.<\/li>\n  <li>On admission days with SO2 levels above the median, mortality was higher (OR <span class='match'>1.13<\/span>; 95% CI <span class='match'>1.10, 1.16<\/span>) at <span class='match'>12.2<\/span>% (95% CI <span class='match'>11.4, 13<\/span>) compared with <span class='match'>10.7<\/span>% (95% CI <span class='match'>10.3, 11.1<\/span>) on days when SO2 levels were below the median.<\/li>\n  <li>Using these methods, we estimated <span class='match'>362000<\/span> (95% confidence interval, <span class='match'>173000551000<\/span>) annual global premature cardiopulmonary deaths attributable to ozone, approximately 50% of the 700000 premature deaths we calculated in our original study (Anenberg et al.<\/li>\n  <li>During the period of high PM10 concentration (>89.82 g/m3), NO2 demonstrated its strongest effect for total non-accidental mortality (ERR%: <span class='match'>0.92<\/span>, 95% CI: <span class='match'>0.421.42<\/span>) and cardiovascular disease mortality (ERR%: <span class='match'>1.20<\/span>, 95% CI: <span class='match'>0.382.03<\/span>).<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Once the effects and CI are identified, some wrangling is necessary in order to get the data into a usable format. We also choose to <strong>drop effects which do not fall into the CI</strong> (62 estimates) in order to get rid off most of the poorly detected effects-CIs.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>estimates_to_clean</span> <span class='op'>&lt;-</span> <span class='va'>detected_effects</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lengths.html'>lengths</a></span><span class='op'>(</span><span class='va'>effect</span><span class='op'>)</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/lengths.html'>lengths</a></span><span class='op'>(</span><span class='va'>CI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#if number of effects != nb of CI for a sentence,</span></span>
<span>  <span class='co'>#can't attribute effects to CI so, drop sentence</span></span>
<span>  <span class='fu'>unnest</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>effect</span>, <span class='va'>CI</span><span class='op'>)</span>, keep_empty <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>CI <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>CI</span>, <span class='st'>"\\s"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='co'># separate(CI, into = c("low_CI", "up_CI"), "([\\s,]+)|(?&lt;!^)[-]") %&gt;% </span></span>
<span>  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>CI</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"low_CI"</span>, <span class='st'>"up_CI"</span><span class='op'>)</span>, <span class='st'>"(?&lt;!^)[:;,%\\-to\\]{1,5}"</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"effect"</span>, <span class='st'>"low_CI"</span>, <span class='st'>"up_CI"</span><span class='op'>)</span>, .fns <span class='op'>=</span> <span class='va'>as.numeric</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    low_CI <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>up_CI</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>low_CI</span><span class='op'>)</span>,</span>
<span>    up_CI <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>low_CI</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>up_CI</span><span class='op'>)</span>,</span>
<span>    effect <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>low_CI</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>effect</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>effect</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>effect</span> <span class='op'>&gt;</span> <span class='va'>low_CI</span> <span class='op'>&amp;</span> <span class='va'>effect</span> <span class='op'>&lt;</span> <span class='va'>up_CI</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="expression-in-terms-of-percentage-change">Expression in terms of percentage change</h3>
<p>Note that some effects are reported in terms of relative risks or odds ratios. We need to express all estimates in terms of percentage increase or raw increases in order to have <span class="math inline">\(H_0: \text{effect} = 0\)</span>. Some abstracts, while mentioning Relative Risk, still report their estimates in terms of percentage. Others report their estimates in terms of actual relative risks, <em>ie</em> in the form 1.024 for a 2.4% increase for instance. We want to convert these terms into percentage changes.</p>
<p>We therefore detect abstracts mentioning Relative Risk or Risk Ratio and among these effects, we retrieve those expressed in actual (RR) terms and those expressed in percents. We then convert expressed in RR terms to percent. To limit further potential misdetection, we only transform effects that are between 0 and 2.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>estimates_RR</span> <span class='op'>&lt;-</span> <span class='va'>estimates_to_clean</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>abstract</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    RR <span class='op'>=</span> <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>abstract</span>, <span class='st'>"((R|r)elative (R|r)isks?|(R|r)isk (R|r)atios?|\\WRR\\W)"</span><span class='op'>)</span>,</span>
<span>    OR <span class='op'>=</span> <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>abstract</span>, <span class='st'>"(O|o)dds (R|r)atios?|\\WOR\\W"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    effect_percent <span class='op'>=</span> <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>sentence</span>, <span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"\\D"</span>, <span class='va'>effect</span>, <span class='st'>"%"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    effect <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>OR</span><span class='op'>|</span><span class='va'>RR</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>effect_percent</span> <span class='op'>&amp;</span> <span class='fu'>between</span><span class='op'>(</span><span class='va'>effect</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>effect</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>, <span class='va'>effect</span><span class='op'>)</span>,</span>
<span>    low_CI <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>OR</span><span class='op'>|</span><span class='va'>RR</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>effect_percent</span> <span class='op'>&amp;</span> <span class='fu'>between</span><span class='op'>(</span><span class='va'>effect</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>low_CI</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>, <span class='va'>low_CI</span><span class='op'>)</span>,</span>
<span>    up_CI <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>OR</span><span class='op'>|</span><span class='va'>RR</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>effect_percent</span> <span class='op'>&amp;</span> <span class='fu'>between</span><span class='op'>(</span><span class='va'>effect</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>up_CI</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>, <span class='va'>up_CI</span><span class='op'>)</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>effect</span>, <span class='va'>low_CI</span>, <span class='va'>up_CI</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="filtering-out-invalid-articles">Filtering out invalid articles</h3>
<p>Reading manually through the abstracts for, we notice that some of the articles returned by the query do not correspond to the type of articles we want to study. For instance, some articles look at the impact of air pollution on animal health. Other articles returned by the query are actually studying long term effects. We therefore looked at all the abstracts and created a dummy variable describing whether these abstracts should be included in the analysis or not.
We filtered at this stage to minimize the number of abstracts to read.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>valid_articles</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/literature_review_epi/inputs/valid_articles.csv"</span>,</span>
<span>                           col_types <span class='op'>=</span> <span class='fu'>cols</span><span class='op'>(</span>valid <span class='op'>=</span> <span class='fu'>col_logical</span><span class='op'>(</span><span class='op'>)</span>, title <span class='op'>=</span> <span class='fu'>col_skip</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>estimates</span> <span class='op'>&lt;-</span> <span class='va'>estimates_RR</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>valid_articles</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># saveRDS(estimates, "data/literature_review_epi/outputs/estimates.RDS")</span></span></code></pre>
</div>
</div>
<p>The <code>estimates</code> data frame displays, in each row, a point estimate and the lower and upper band of the CI along with the DOI of the article from which this estimate is extracted. We retrieved 2666 valid point estimates and associated confidence intervals. We analyze them further in another document.</p>
<h2 id="retreiving-additional-information">Retreiving additional information</h2>
<p>It might also be interesting to have information about the type of pollutant considered in the study, the study period, the number of observations or the type of outcome studied (mortality, emergency admissions, stroke, cerebrovascular or cardiovascular diseases). We thus use regex to recover this information. Of course, this does not enable us to retrieve data for all the abstracts considered but it provides a useful source of information; retrieving this information by hand is extremely cumbersome. Regex are thus very helpful here. They also make this analysis reproducible.</p>
<h3 id="number-of-obsrvations">Number of obsrvations</h3>
<p>In most studies in this field, observations are daily and at the city level. To compute the number of observations, we thus retrieve the length of the study period from the abstract when possible, along with the number of cities considered in the study.</p>
<h4 id="length-of-the-study-period">Length of the study period</h4>
<p>To compute the length of the study period, we look for beginning and end dates for the period of study in the abstract. Some abstracts contain phrases such as from January 2002 to March 2011 to indicate the study period. We take advantage of such mentions to retrieve the study period. Before anything, we transform the text data to a date format using the function <code>text_to_date</code>. Then, we detect, the study periods and wrangle them into a usable format. If we retrieve several length for a unique article, we take a conservative approach and only keep the longer one.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>abstracts_only</span> <span class='op'>&lt;-</span> <span class='va'>abstracts</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>abstract <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>abstract</span>, <span class='st'>""</span>, <span class='st'>"."</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>abstract</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>month_regex</span> <span class='op'>&lt;-</span> <span class='fu'>str_c</span><span class='op'>(</span></span>
<span>  <span class='st'>"\\b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|"</span>, </span>
<span>  <span class='st'>"Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|(Nov|Dec)(?:ember)?)"</span><span class='op'>)</span></span>
<span><span class='va'>date_regex</span> <span class='op'>&lt;-</span> <span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"("</span>, <span class='va'>month_regex</span>, <span class='st'>"\\s){0,1}(19|20)\\d{2}"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>text_to_date</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>date_text</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>year</span> <span class='op'>&lt;-</span>  <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>date_text</span>, <span class='st'>"[^\\d]"</span><span class='op'>)</span></span>
<span>  <span class='va'>month</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>date_text</span>, <span class='st'>"[\\d\\s]"</span><span class='op'>)</span>, <span class='va'>month.name</span><span class='op'>)</span></span>
<span>  <span class='va'>month</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>month</span><span class='op'>)</span>, <span class='st'>"01"</span>, <span class='va'>month</span><span class='op'>)</span></span>
<span>  <span class='va'>date</span> <span class='op'>&lt;-</span> <span class='fu'>dmy</span><span class='op'>(</span><span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"01-"</span>, <span class='fu'>str_pad</span><span class='op'>(</span><span class='va'>month</span>, width <span class='op'>=</span> <span class='fl'>2</span>, pad <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, <span class='st'>"-"</span>, <span class='va'>year</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>articles_length_study</span> <span class='op'>&lt;-</span> <span class='va'>abstracts_only</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    dates_obs <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>abstract</span>, </span>
<span>      <span class='fu'>str_c</span><span class='op'>(</span></span>
<span>        <span class='st'>"("</span>, <span class='va'>date_regex</span>, <span class='st'>"|"</span>, <span class='va'>month_regex</span>, <span class='st'>")"</span>, </span>
<span>        <span class='st'>"( to |\\s?\\s?|\\s?-\\s?| and )"</span>, </span>
<span>        <span class='va'>date_regex</span></span>
<span>      <span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>dates_obs</span>, keep_empty <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>separate</span><span class='op'>(</span></span>
<span>    <span class='va'>dates_obs</span>, </span>
<span>    into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"begin_obs"</span>, <span class='st'>"end_obs"</span><span class='op'>)</span>, </span>
<span>    <span class='st'>"( to |\\s?\\s?|\\s?-\\s?| and )"</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span><span class='co'>#when begin_obs and end_obs are in the same year, </span></span>
<span>    <span class='co'>#we only get the month for begin_obs</span></span>
<span>    begin_obs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>begin_obs</span>, <span class='st'>"\\d"</span><span class='op'>)</span>, </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>begin_obs</span>, <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>end_obs</span>, <span class='st'>"[^\\d]"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='va'>begin_obs</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    begin_obs <span class='op'>=</span> <span class='fu'>text_to_date</span><span class='op'>(</span><span class='va'>begin_obs</span><span class='op'>)</span>,</span>
<span>    end_obs <span class='op'>=</span> <span class='fu'>text_to_date</span><span class='op'>(</span><span class='va'>end_obs</span><span class='op'>)</span>,</span>
<span>    length_study <span class='op'>=</span> <span class='fu'>time_length</span><span class='op'>(</span><span class='va'>end_obs</span> <span class='op'>-</span> <span class='va'>begin_obs</span>, unit <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span>,</span>
<span>    length_study <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>length_study</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>|</span> <span class='va'>end_obs</span> <span class='op'>&gt;</span> <span class='fu'>today</span><span class='op'>(</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>length_study</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>length_study</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    length_study <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>length_study</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    length_study <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>length_study</span> <span class='op'>&lt;</span> <span class='fl'>0</span>, <span class='cn'>NA</span>, <span class='va'>length_study</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We retrieve a length of the study for 34.351145% of the articles. Note that with this method, we may miss studies which span for exactly a year, <em>eg</em> when only 2011 is mentioned.</p>
<h4 id="number-of-cities-considered">Number of cities considered</h4>
<p>We then try to detect the number of cities considered in each abstract. To do so, we use two different techniques:</p>
<ul>
<li>We see whether the abstract uses phrases such as in 34 cities and retrieve this 34. We also convert all text-numbers (<em>eg</em> one) into their numerical values. When we get several numbers, we take a conservative approach and only keep the largest one.</li>
<li>We count the number of cities names appearing uniquely in each abstract. To do so, we use a database of cities names. We restrict our sample to large cities.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>number_word</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span></span>
<span>  number <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5000</span>, </span>
<span>  word <span class='op'>=</span> <span class='fu'>english</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/english/man/words.html'>words</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5000</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>abstracts_in_numbers</span> <span class='op'>&lt;-</span> <span class='va'>abstracts_only</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>unnest_tokens</span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>abstract</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>number_word</span>, by <span class='op'>=</span> <span class='st'>"word"</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>number</span><span class='op'>)</span>, <span class='va'>number</span>, <span class='va'>word</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>number</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>summarize</span><span class='op'>(</span>abstract <span class='op'>=</span> <span class='fu'>str_c</span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>abstract <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>abstract</span>, <span class='st'>"-"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Source: https://simplemaps.com/data/world-cities</span></span>
<span><span class='va'>worldcities</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/literature_review_epi/inputs/worldcities.csv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>worldcities_large</span> <span class='op'>&lt;-</span> <span class='va'>worldcities</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    city_regex <span class='op'>=</span> <span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"\\b"</span>, <span class='va'>city_ascii</span>, <span class='st'>"\\b"</span><span class='op'>)</span>,</span>
<span>    city_regex <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>city_regex</span><span class='op'>)</span>,</span>
<span>    city_regex <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>city_regex</span>, <span class='st'>"-"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>population</span> <span class='op'>&gt;</span> <span class='fl'>500000</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>articles_number_cities</span> <span class='op'>&lt;-</span> <span class='va'>abstracts_in_numbers</span> <span class='op'>%&gt;%</span> </span>
<span>   <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    n_many_cities <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>abstract</span>, </span>
<span>      <span class='co'># "(?&lt;!more\\sthan)\\d+(?=\\s?(c|C)it(y|ies))"</span></span>
<span>      <span class='st'>"\\d+(?=\\s?(c|C)it(y|ies))"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    abstract_ascii <span class='op'>=</span> <span class='fu'>stringi</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/stringi/man/stri_trans_general.html'>stri_trans_general</a></span><span class='op'>(</span><span class='va'>abstract</span>,<span class='st'>"Latin-ASCII"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    abstract_ascii <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>abstract_ascii</span>, <span class='st'>"-"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>n_many_cities</span>, keep_empty <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>n_many_cities <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>n_many_cities</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>n_many_cities <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>n_many_cities</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    n_names_cities <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span><span class='va'>abstract_ascii</span>, <span class='va'>worldcities_large</span><span class='op'>[[</span><span class='st'>"city_regex"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>      <span class='fu'>as_vector</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    n_cities <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>n_many_cities</span>, <span class='va'>n_names_cities</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    n_cities <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>n_cities</span> <span class='op'>==</span> <span class='fl'>0</span>, <span class='cn'>NA</span>, <span class='va'>n_cities</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>n_cities</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We retrieve a number of cities considered in the study for 45.3653217% of the articles.</p>
<h4 id="number-of-observations">Number of observations</h4>
<p>Finally, we combine these two information to compute the number of observations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>articles_n_obs</span> <span class='op'>&lt;-</span> <span class='va'>articles_length_study</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>articles_number_cities</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>n_cities</span><span class='op'>*</span><span class='va'>length_study</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We retrieve a number of cities considered in the study for 20.4471101% of the articles.</p>
<h3 id="pollutant-studied">Pollutant studied</h3>
<p>We then recover, when possible, the pollutant(s) considered in the study. We assume that only pollutants studied are mentioned in the abstract. This might be slightly inaccurate but seems to be a coherent first order approximation. We recognize that some pollutants may be mentioned in an abstract even though the corresponding study does not run any analysis on these pollutants and outcomes. We however assume that it is rather unlikely that a study on particulate matter pollution for instance will also talk about ozone <strong>in its abstract</strong>. Note that there are sometimes several pollutants mentioned in an abstract and analyzed in a study.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>abstracts_with_titles</span> <span class='op'>&lt;-</span> <span class='va'>abstracts</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    abstract <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>abstract</span>, <span class='st'>""</span>, <span class='st'>"."</span><span class='op'>)</span>,</span>
<span>    abstract_title <span class='op'>=</span> <span class='fu'>str_c</span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>abstract</span>, sep <span class='op'>=</span> <span class='st'>". "</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>abstract_title</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>articles_pollutant</span> <span class='op'>&lt;-</span> <span class='va'>abstracts_with_titles</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    pollutant <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>abstract_title</span>,</span>
<span>      <span class='fu'>str_c</span><span class='op'>(</span><span class='st'>"(\\bPM\\s?2(\\.|,)5|\\bPM\\s?10|\\bO\\s?3\\b|\\b(o|O)zone\\b|"</span>,</span>
<span>            <span class='st'>"\\b(P|p)articulate(\\s(M|m)atter\\b)?|\\bNO\\s?2|"</span>,</span>
<span>            <span class='st'>"\\b(n|N)itrogen\\s?(d|D)ioxide\\b|\\bNO\\b|"</span>,</span>
<span>            <span class='st'>"\\b(n|N)itrogen\\s?(o|O)xide\\b|\\bNO\\s?(x|X)\\b|\\bSO\\s?2|"</span>,</span>
<span>            <span class='st'>"\\bCO\\b|\\bBC\\b|\\b(A|a)ir\\s(Q|q)uality\\s(I|i)ndex\\b)"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>pollutant</span>, keep_empty <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    pollutant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>pollutant</span><span class='op'>)</span>, </span>
<span>    pollutant <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>pollutant</span>, <span class='st'>"\\s"</span>, <span class='st'>""</span><span class='op'>)</span>,</span>
<span>    pollutant <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>pollutant</span>, <span class='st'>","</span>, <span class='st'>"\\."</span><span class='op'>)</span>,</span>
<span>    pollutant <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span></span>
<span>      <span class='va'>pollutant</span> <span class='op'>==</span> <span class='st'>"nitrogendioxide"</span> <span class='op'>~</span> <span class='st'>"no2"</span>,</span>
<span>      <span class='va'>pollutant</span> <span class='op'>==</span> <span class='st'>"nitrogenoxide"</span> <span class='op'>~</span> <span class='st'>"no"</span>, </span>
<span>      <span class='va'>pollutant</span> <span class='op'>==</span> <span class='st'>"ozone"</span> <span class='op'>~</span> <span class='st'>"o3"</span>,</span>
<span>      <span class='va'>pollutant</span> <span class='op'>==</span> <span class='st'>"particulate"</span> <span class='op'>~</span> <span class='st'>"particulatematter"</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>pollutant</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    pollutant <span class='op'>=</span> <span class='fu'>str_to_upper</span><span class='op'>(</span><span class='va'>pollutant</span><span class='op'>)</span>,</span>
<span>    pollutant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>pollutant</span> <span class='op'>==</span> <span class='st'>"PARTICULATEMATTER"</span>, <span class='st'>"Particulate matter"</span>, <span class='va'>pollutant</span><span class='op'>)</span>,</span>
<span>    pollutant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>pollutant</span> <span class='op'>==</span> <span class='st'>"AIRQUALITYINDEX"</span>, <span class='st'>"Air Quality Index"</span>, <span class='va'>pollutant</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>pollutant</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>abstract_title</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>nest</span><span class='op'>(</span>pollutant <span class='op'>=</span> <span class='va'>pollutant</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We identify pollutants considered in the study for 82.4427481% of the articles.</p>
<h3 id="outcome-considered">Outcome considered</h3>
<p>Following a similar methodology as for pollutants, we retrieve information about the outcomes considered.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>articles_outcome</span> <span class='op'>&lt;-</span> <span class='va'>abstracts_with_titles</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    outcome <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>abstract_title</span>, </span>
<span>      <span class='st'>"(\\b(M|m)ortality\\b|\\b(D|d)eath(s)?\\b|\\b(H|h)ospitalization|\\b(E|e)mergenc)"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>outcome</span>, keep_empty <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>   <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    outcome <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>outcome</span><span class='op'>)</span>,</span>
<span>    outcome <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>str_starts</span><span class='op'>(</span><span class='va'>outcome</span>, <span class='st'>"emergenc|hospitalization"</span><span class='op'>)</span>, <span class='st'>"Emergency"</span>,</span>
<span>                     <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>str_starts</span><span class='op'>(</span><span class='va'>outcome</span>, <span class='st'>"death|mortalit"</span><span class='op'>)</span>, <span class='st'>"Mortality"</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>outcome</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>nest</span><span class='op'>(</span>outcome <span class='op'>=</span> <span class='va'>outcome</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>abstract_title</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We identify outcomes considered in the study for 81.4067612% of the articles.</p>
<h3 id="sub-population-considered">Sub-population considered</h3>
<p>Using a similar methodology, we try to identify the sub-population considered (infants or elderly). Note that, when the whole population is studied, we do not recover any information. It might be a bit far fetch to consider that when no sub-population is mentioned, the whole population is studied. We therefore abstain from doing so.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>articles_subpop</span> <span class='op'>&lt;-</span> <span class='va'>abstracts_with_titles</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    subpop <span class='op'>=</span> <span class='fu'>str_extract_all</span><span class='op'>(</span></span>
<span>      <span class='va'>abstract_title</span>, </span>
<span>      <span class='st'>"(\\b(I|i)nfant|\\b(E|e)lder)"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>subpop</span>, keep_empty <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>   <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    subpop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>subpop</span><span class='op'>)</span>,</span>
<span>    subpop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>str_starts</span><span class='op'>(</span><span class='va'>subpop</span>, <span class='st'>"infant"</span><span class='op'>)</span>, <span class='st'>"Infants"</span>,</span>
<span>                     <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>str_starts</span><span class='op'>(</span><span class='va'>subpop</span>, <span class='st'>"elder"</span><span class='op'>)</span>, <span class='st'>"Elders"</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>subpop</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>nest</span><span class='op'>(</span>subpop <span class='op'>=</span> <span class='va'>subpop</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>abstract_title</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We identify sub-population considered in the study for 12.9770992% of the articles.</p>
<h3 id="additional-information-on-journals">Additional information on journals</h3>
<p>It is also interesting to have access to journal fields. This will enable us to see whether some academic research fields are more subject to certain type of issues than others.</p>
<p>We retrieve information on journal fields from Scopus. In <a href="https://www.scopus.com/sources.uri">their source list</a>, they classify all journals into approximately 330 sub-subject areas. We thus match this with journal names from our database. Scopus also provides coarser subject area categorizations, for instance one with 5 fields: Multidisciplinary, Physical Sciences, Health Sciences, Social Sciences and Life Science. They provide <a href="https://service.elsevier.com/app/answers/detail/a_id/15181/supporthub/scopus/">a correspondance table</a> between those two classifications.</p>
<p>Note that, some journals mention several of these fields as references. We choose to classify those as multidisciplinary journals.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>subject_subsubject_corres</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/literature_review_epi/inputs/scopus_subject_corres.csv"</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>rename</span><span class='op'>(</span></span>
<span>    area_code <span class='op'>=</span> <span class='va'>Code</span>,</span>
<span>    subsubject_area <span class='op'>=</span> <span class='va'>Field</span>, </span>
<span>    subject_area <span class='op'>=</span> <span class='va'>`Subject area`</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>drop_na</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>journal_subsubject_corres</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/literature_review_epi/inputs/scopus_journal_subsubject.csv"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename</span><span class='op'>(</span></span>
<span>    journal <span class='op'>=</span> <span class='va'>Title</span>,</span>
<span>    subsubject_area <span class='op'>=</span> <span class='va'>`Scopus Sub-Subject Area`</span>,</span>
<span>    area_code <span class='op'>=</span> <span class='va'>`Scopus ASJC Code (Sub-subject Area)`</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>journal</span>, <span class='va'>subsubject_area</span>, <span class='va'>area_code</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#To classify journals as multidisciplinary</span></span>
<span><span class='va'>journal_subject_corres</span> <span class='op'>&lt;-</span> <span class='va'>journal_subsubject_corres</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>subject_subsubject_corres</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"area_code"</span>, <span class='st'>"subsubject_area"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>journal</span>, <span class='va'>subject_area</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>journal</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    n_subject_area <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    subject_area <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>n_subject_area</span> <span class='op'>&gt;</span> <span class='fl'>1</span>, <span class='st'>"Multidisciplinary"</span>, <span class='va'>subject_area</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>n_subject_area</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>journal_subject</span> <span class='op'>&lt;-</span> <span class='va'>journal_subsubject_corres</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>journal_subject_corres</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"journal"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    journal_merge <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>journal</span><span class='op'>)</span>,</span>
<span>    journal_merge <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>journal_merge</span>, <span class='st'>"[^\\w\\s]"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>articles_journal_subject</span> <span class='op'>&lt;-</span> <span class='va'>abstracts</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span></span>
<span>    journal_merge <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>journal</span><span class='op'>)</span>,</span>
<span>    journal_merge <span class='op'>=</span> <span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>journal_merge</span>, <span class='st'>"[^\\w\\s]"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>journal_subject</span>, by <span class='op'>=</span> <span class='st'>"journal_merge"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>doi</span>, <span class='va'>subject_area</span>, <span class='va'>subsubject_area</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>nest</span><span class='op'>(</span>subsubject_area <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>subsubject_area</span><span class='op'>)</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>We retrieve information about the subject area for 87.7317339% articles and about the subsubject area for 94.1668846% of articles.</p>
<h2 id="agregating-the-information">Agregating the information</h2>
<p>Finally, we build the overall metadata set, by combining all the previous information.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>abstracts_and_metadata</span> <span class='op'>&lt;-</span> <span class='va'>abstracts</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>articles_n_obs</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>articles_pollutant</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>articles_outcome</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>articles_subpop</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>articles_journal_subject</span>, by <span class='op'>=</span> <span class='st'>"doi"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>doi</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span></span>
<span>    <span class='va'>pub_date</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>pub_date</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>|</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>pub_date</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#some articles have been published twice</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># saveRDS(abstracts_and_metadata, "data/literature_review_epi/outputs/abstracts_and_metadata.RDS")</span></span></code></pre>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>In case any problem remains, we use tryCatch to record the DOIs corresponding to errors in order to be able to handle them later.<a href="#fnref1" class="footnote-back" role="doc-backlink"></a></p></li>
<li id="fn2"><p>We analyze the characteristics of articles doing so in another document.<a href="#fnref2" class="footnote-back" role="doc-backlink"></a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
